#ifndef LIGHTING_ZC
#define LIGHTING_ZC

//> This file contains lighting-related structures and functions

import "blocks.zc";

struct LightNode {
    x: int;
y: int;
    z: int;
}

// Aumentamos un poco el tama침o y usamos l칩gica circular
def MAX_LIGHT_QUEUE = 131072;

struct LightQueue {
    nodes: LightNode[131072]; // Debe coincidir con MAX_LIGHT_QUEUE
    head: int;
tail: int;
}

fn queue_push(q: LightQueue*, x: int, y: int, z: int) {
    // Calculamos la siguiente posici칩n circular
    let next_tail = (q.tail + 1) % MAX_LIGHT_QUEUE;
    
    // Si no alcanzamos a la cabeza (la cola no est치 llena realmente)
    if next_tail != q.head {
        q.nodes[q.tail].x = x;
q.nodes[q.tail].y = y;
        q.nodes[q.tail].z = z;
        q.tail = next_tail;
    }
}

fn queue_pop(q: LightQueue*) -> LightNode {
    let n: LightNode;
n = q.nodes[q.head];
    // Avance circular de la cabeza
    q.head = (q.head + 1) % MAX_LIGHT_QUEUE;
    return n;
}

fn queue_is_empty(q: LightQueue*) -> int {
    return q.head == q.tail;
}

#endif // LIGHTING_ZC